<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"></meta>
    <title>Colonial New World Publishing</title>
    <script type="text/javascript" src="http://d3js.org/d3.v3.min.js"></script>
    <style type="text/css">

svg {
  width: 900px;
  height: 1000px;
}

#words {
  margin-left: 160px;
}

h1 {
   color: #333;
}

a {
    color: #333;
    font-weight: bold;
    text-decoration:none;
}

text {
  font: 10px sans-serif;
}

#states path, #states-towns circle {
  fill: #ccc;
  stroke: #fff;
  stroke-width: 1.5px;
}

#state-centroids circle {
  fill: steelblue;
  stroke: darkblue;
  stroke-width: 1px;
  padding: 2px;
  fill-opacity: .8;
}

    </style>
   <link rel="stylesheet" type="text/css" href="../genres.css">
  </head>
    <div id="allcontent">
        <div id ="he
  <body>ader">
          <a href="../index.html"><img src="../images/HeaderGraphic.jpg"></a>
          <div id="creators">
            <p> <span class="smallcaps">created by</span>
              <a target="_blank" href="http://research.brown.edu/myresearch/James_Egan">Jim Egan</a> &amp;
              <a target="_blank" href="http://www.jeanbauer.com">Jean Bauer</a>&nbsp;
            </p>
          </div><!-- end creators -->
        </div><!-- end header -->
        <div id="wrapper">
      <h2>Sites of New World Publishing, 1535-1800</h2>
      <p>This map shows the location of printing presses in the Americas from 1535 to 1800 and gives a rough visual estimate of each location's published output.  Data provided by <a target="_blank" href="http://library.brown.edu/">The Brown University Library</a> and <a target="_blank" href="http://www.brown.edu/academics/libraries/john-carter-brown/">The John Carter Brown Library</a>.</p>
      <p>Mouse over a circle to see the full name of the place and the total number of works published there.  For the smallest circules, placing your cursor just above the top of the circle works best.</p>
      <p><span class="notebene">Note on visualization:</span> Circles are drawn in descending order of size to ensure that larger publishing centers do not 'obliterate' smaller ones.  However, the temporal aspect of this vizualization <em>has no relation to chronological time</em>.</p>
      <p>Built with the <a target="_blank" href="http://d3js.org">d3.js</a> javascript library </p>
    </div>
      
    <script type="text/javascript">

// The radius scale for the centroids.
// r behaves like a function - it accepts a number as input and returns a new number as output
var r = d3.scale.sqrt()
    .domain([0, 1e3])
    .range([1, 10]);

//this code defines a method format that takes an integer as input and returns a neater integer output formatted with a comma
var format = d3.format(",d");

// Our projection.
// xy is a predefined map projection that is used later in the code to format the US/Canada boundaries Json data file. xy is an orthographic projection
var xy = d3.geo.orthographic()
    .scale(400)
    .rotate([90,-20])
    .clipAngle(90);

//svg is the variable for the svg canvas upon which we draw the map and printing press locations. It is located in the div #wrapper
var svg = d3.select("#wrapper").append("svg");

//Here we append 2 'g' element to our svg variable. The g element is a container element for grouping together related graphics elements (such as circle or ellipse)  
//The first g element has the id #states and will contain the graphics made from the data from the US/Canada boundaries 
svg.append("g").attr("id", "states");
//The second g element has the id #state-centroids and will contain the graphics made from the data about the printing presses
svg.append("g").attr("id", "state-centroids");

//the first part of the below code loops through the collections in the world-countries json file (there is only one collection)
d3.json("../data/world-countries.json", function(collection) {
  //for each collection, the svg object selects the #states g element
    svg.select("#states")
        .selectAll("path")
        //then, we loop through the features in the collection (there are 2, the US and Canada)
        .data(collection.features)
        .enter()
        //we append an empty path object for each feature
        .append("path")
        //we set the attributes on the path object to draw the map using our previously defined xy projection
        .attr("d", d3.geo.path().projection(xy));
});

//comments to be continued...



d3.json("../data/JosiahPre1800Locations2-6-13.json", function(collection) {
  var place = svg.select("#state-centroids")
    .selectAll("circle")
      .data(collection.rows
      .sort(function(a, b) { return b.TotalPublished - a.TotalPublished; }))
    .enter().append("circle")
      .attr("transform", function(d) { return "translate(" + xy(d.coordinates) + ")"; })
      .attr("r", 0);
  
  place.transition()
      .duration(1000)
      .delay(function(d, i) { return i * 50; })
      .attr("r", function(d) { return r(d.TotalPublished); });
  
  place.append("title")
    .text(function(d) { return d.Name + ": " + format(d.TotalPublished); });
});

    </script>
        <div id="footer">
          <p><em>The Mapping Colonial Americas Publishing Project</em></p>
          <div id="footer_credits">
            <a target="_blank" href="http://library.brown.edu"><img src="../images/brown.gif" title="Brown University Library"></a>
            <a target="_blank" href="http://library.brown.edu/cds"><img src="../images/CDS_orange_circle.png" title="A Center for Digital Scholarship Project"></a>
           </div>
        </div><!--end footer-->
      </div><!-- end allcontent -->
    </body>
</html>